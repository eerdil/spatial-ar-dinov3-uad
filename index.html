<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Spatial Autoregressive Modeling of DINOv3 Embeddings for Unsupervised Anomaly Detection</title>

  <script src="https://cdn.plot.ly/plotly-2.30.0.min.js"></script>

  <style>
    :root{
      --bg:#ffffff;
      --fg:#111827;
      --muted:#4b5563;
      --border:#e5e7eb;
      --card:#f9fafb;
      --link:#2563eb;
      --link2:#1d4ed8;
      --pill:#eef2ff;
      --shadow: 0 10px 30px rgba(0,0,0,.06);
    }
    @media (prefers-color-scheme: dark){
      :root{
        --bg:#0b0f19;
        --fg:#e5e7eb;
        --muted:#9ca3af;
        --border:#1f2937;
        --card:#0f1626;
        --link:#60a5fa;
        --link2:#93c5fd;
        --pill:#111a33;
        --shadow: 0 10px 30px rgba(0,0,0,.35);
      }
    }

    html,body{
      background:var(--bg);color:var(--fg);margin:0;
      font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";
    }
    a{color:var(--link);text-decoration:none}
    a:hover{color:var(--link2);text-decoration:underline}

    .wrap{max-width:1100px;margin:0 auto;padding:34px 18px 64px}
    .center{text-align:center}
    .title{font-size:30px;line-height:1.15;margin:30px 0 25px 0}

    .authors{margin-top:10px;color:var(--muted);font-size:18px;font-weight:600;}
    .affil{margin-top:6px;color:var(--muted);font-size:15px;font-weight:400;}
    .email{margin-top:6px;color:var(--muted);font-size:14px}

    .pillrow{display:flex;justify-content:center;gap:10px;flex-wrap:wrap;margin:24px 0;}
    .pill{
      display:inline-flex;align-items:center;gap:8px;
      background:var(--pill);border:1px solid var(--border);
      padding:10px 12px;border-radius:999px;font-size:14px;
      box-shadow: var(--shadow);
    }
    .pill svg{width:16px;height:16px}

    .section{margin-top:26px}
    .card{
      background:var(--card);border:1px solid var(--border);
      border-radius:16px;padding:18px;box-shadow: var(--shadow);
    }
    h2{font-size:18px;margin:0 0 10px}
    p{margin:10px 0;line-height:1.6}
    .muted{color:var(--muted)}

    .abstract-text{
      max-width:900px;
      margin:0 auto;
      text-align: justify;
      text-justify: inter-word;
      hyphens: auto;
    }

    .plot-grid{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:14px;
    }
    @media (max-width: 980px){
      .plot-grid{grid-template-columns: 1fr;}
    }
    .plot-box{
      border:1px solid var(--border);
      border-radius:16px;
      overflow:hidden;
      background:var(--bg);
      box-shadow: var(--shadow);
    }
    .plot-title{
      padding:10px 12px;
      border-bottom:1px solid var(--border);
      font-weight:600;
      color:var(--muted);
      background:var(--card);
      text-align:center;
    }
    .plot{height:320px;}
    @media (max-width: 980px){
      .plot{height:360px;}
    }

    .divider{margin-top:26px;border-top:1px solid var(--border)}
    .codebox{
      background:#0b1020;color:#e5e7eb;border-radius:14px;
      padding:14px;overflow:auto;border:1px solid var(--border);
      text-align:left;
    }
    @media (prefers-color-scheme: dark){
      .codebox{background:#0a0d14;}
    }
    pre{
      margin:0;
      font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;
      font-size:13px;line-height:1.5
    }
    .footer{margin-top:28px;color:var(--muted);font-size:13px;text-align:center}
  </style>
</head>

<body>
  <div class="wrap">

    <header class="center">
      <h1 class="title">Spatial Autoregressive Modeling of DINOv3 Embeddings for Unsupervised Anomaly Detection</h1>
      <div class="authors">Ertunc Erdil*, Nico Schulthess, Guney Tombak, Ender Konukoglu</div>
      <div class="affil">Computer Vision Lab., ETH Zurich, Zurich, Switzerland</div>
      <div class="email">*<a href="mailto:erdile@ethz.ch">erdile@ethz.ch</a></div>

      <div class="pillrow">
        <a class="pill" href="assets/paper.pdf" target="_blank" rel="noopener">
          <svg viewBox="0 0 24 24" fill="none"><path d="M7 3h7l3 3v15a3 3 0 0 1-3 3H7a3 3 0 0 1-3-3V6a3 3 0 0 1 3-3Z" stroke="currentColor" stroke-width="1.6"/><path d="M14 3v4a2 2 0 0 0 2 2h4" stroke="currentColor" stroke-width="1.6"/></svg>
          Paper (PDF)
        </a>

        <a class="pill" href="https://github.com/eerdil/spatial-ar-dinov3-uad" target="_blank" rel="noopener">
          <svg viewBox="0 0 24 24" fill="none"><path d="M9 19c-4 1.5-4-2.5-5-3m10 6v-3.5c0-1 .1-1.4-.5-2 2.2-.3 4.5-1.1 4.5-5A4 4 0 0 0 17 8a3.7 3.7 0 0 0-.1-3S16 4.7 14 6a13.4 13.4 0 0 0-5 0C7 4.7 6.1 5 6.1 5A3.7 3.7 0 0 0 6 8a4 4 0 0 0-1 2.9c0 3.9 2.3 4.7 4.5 5-.4.4-.5 1-.5 2V22" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>
          Code
        </a>
      </div>
    </header>

    <!-- Abstract FIRST -->
    <section class="section">
      <div class="card">
        <h2 class="center">Abstract</h2>
        <p class="abstract-text">
          DINO models provide rich patch-level representations that have recently enabled strong performance in unsupervised anomaly detection (UAD).
          Most existing methods extract patch embeddings from “normal” images and model them independently, ignoring spatial and neighborhood relationships between patches.
          In addition, the normative distribution is often modeled as memory banks or prototype-based representations, which require storing large numbers of features and performing costly comparisons at inference time, leading to substantial memory and computational overhead.
          In this work, we address both limitations by proposing a simple and efficient framework that explicitly models spatial and contextual dependencies between patch embeddings using a 2D autoregressive (AR) model.
          Instead of storing embeddings or clustering prototypes, our approach learns a compact parametric model of the normative distribution via an AR convolutional neural network (CNN).
          At test time, anomaly detection reduces to a single forward pass through the network and enables fast and memory-efficient inference.
          We evaluate our method on the BMAD benchmark, which comprises three medical imaging datasets, and compare it against existing work including recent DINO-based methods.
          Experimental results demonstrate that explicitly modeling spatial dependencies achieves competitive anomaly detection performance while substantially reducing inference time and memory requirements.
        </p>
      </div>
    </section>

    <!-- Results SECOND, with a title like Abstract -->
    <section class="section">
      <div class="card">
        <h2 class="center">Results</h2>
        <div class="center muted" style="margin-top:2px;margin-bottom:10px;">
          Interactive results (hover points to see exact values).
        </div>

        <div class="plot-grid">
          <div class="plot-box">
            <div class="plot-title">BraTS2021 — AUROC vs Runtime</div>
            <div id="plot_auroc_brats" class="plot"></div>
          </div>
          <div class="plot-box">
            <div class="plot-title">BTCV+LiTs — AUROC vs Runtime</div>
            <div id="plot_auroc_liver" class="plot"></div>
          </div>
          <div class="plot-box">
            <div class="plot-title">RESC — AUROC vs Runtime</div>
            <div id="plot_auroc_resc" class="plot"></div>
          </div>
        </div>

        <div style="height:14px;"></div>

        <div class="plot-grid">
          <div class="plot-box">
            <div class="plot-title">BraTS2021 — AUPR vs Runtime</div>
            <div id="plot_aupr_brats" class="plot"></div>
          </div>
          <div class="plot-box">
            <div class="plot-title">BTCV+LiTs — AUPR vs Runtime</div>
            <div id="plot_aupr_liver" class="plot"></div>
          </div>
          <div class="plot-box">
            <div class="plot-title">RESC — AUPR vs Runtime</div>
            <div id="plot_aupr_resc" class="plot"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- Citation -->
    <!-- <section class="section">
      <div class="card center">
        <h2>Citation</h2>
        <p class="muted">Update this BibTeX entry with the final venue/year once available.</p>
        <div class="codebox" style="max-width:900px;margin:0 auto;">
<pre>@inproceedings{erdil2025spatialar,
  title     = {Spatial Autoregressive Modeling of DINOv3 Embeddings for Unsupervised Anomaly Detection},
  author    = {Erdil, Ertunc and Schulthess, Nico and Tombak, Guney and Konukoglu, Ender},
  booktitle = {Proceedings of ...},
  year      = {2025}
}</pre>
        </div>
      </div>
    </section> -->

    <div class="divider"></div>
    <div class="footer">© <span id="year"></span> — Project page</div>
  </div>

  <script>
    document.getElementById("year").textContent = new Date().getFullYear();

    const COLOR_MAP = {
      "DRAEM": "#1f77b4",
      "UTRAD": "#ff7f0e",
      "RD4AD": "#2ca02c",
      "STFPM": "#d62728",
      "PaDiM": "#9467bd",
      "PatchCore": "#8c564b",
      "CFA": "#e377c2",
      "CFLOW": "#7f7f7f",
      "AnomalyDINO (v2-S)": "#bcbd22",
      "AnomalyDINO (v3-S)": "#b5bd00",
      "DPMM (v2-S)": "#17becf",
      "DPMM (v3-S)": "#00a1c9",
      "Ours (standard conv)": "#f1c40f",
      "Ours (dilated conv)": "#ffdd00"
    };

    const METHODS = [
      {name:"DRAEM",        runtime:130, auroc:{brats:[63.85,16.37], liver:[89.42,4.96], resc:[88.81,3.95]}, aupr:{brats:[14.61,7.94], liver:[7.03,4.79], resc:[38.05,9.94]}},
      {name:"UTRAD",        runtime:42,  auroc:{brats:[47.47,3.78],  liver:[85.54,0.36], resc:[94.62,0.11]}, aupr:{brats:[3.11,0.25],  liver:[1.36,0.04], resc:[49.57,1.20]}},
      {name:"RD4AD",        runtime:117, auroc:{brats:[97.85,0.05],  liver:[95.54,1.73], resc:[96.84,0.23]}, aupr:{brats:[52.98,1.25], liver:[4.71,1.80], resc:[64.77,3.33]}},
      {name:"STFPM",        runtime:111, auroc:{brats:[96.84,0.58],  liver:[96.30,0.15], resc:[95.11,0.31]}, aupr:{brats:[43.86,5.28], liver:[5.44,0.29], resc:[54.10,1.02]}},
      {name:"PaDiM",        runtime:129, auroc:{brats:[83.59,0.80],  liver:[90.35,0.17], resc:[91.88,0.07]}, aupr:{brats:[7.02,0.32],  liver:[1.76,0.03], resc:[33.09,1.73]}},
      {name:"PatchCore",    runtime:218, auroc:{brats:null,          liver:[96.63,0.00], resc:[97.57,0.01]}, aupr:{brats:null,          liver:[6.00,0.01], resc:[72.77,0.06]}},
      {name:"CFA",          runtime:116, auroc:{brats:[97.33,0.09],  liver:[97.14,0.13], resc:[93.11,0.02]}, aupr:{brats:[54.67,0.69], liver:[7.13,0.41], resc:[30.84,0.09]}},
      {name:"CFLOW",        runtime:219, auroc:{brats:[94.93,0.71],  liver:[92.88,2.17], resc:[94.68,0.05]}, aupr:{brats:[34.99,6.26], liver:[3.46,0.70], resc:[52.23,1.19]}},
      {name:"AnomalyDINO (v2-S)", runtime:984, auroc:{brats:[97.71,0.00], liver:[97.24,0.00], resc:[94.04,0.00]}, aupr:{brats:[58.69,0.00], liver:[17.91,0.00], resc:[50.45,0.00]}},
      {name:"AnomalyDINO (v3-S)", runtime:585, auroc:{brats:[98.38,0.00], liver:[96.98,0.00], resc:[96.93,0.00]}, aupr:{brats:[69.49,0.00], liver:[5.35,0.00],  resc:[63.40,0.00]}},
      {name:"DPMM (v2-S)",        runtime:58,  auroc:{brats:[91.16,3.72],  liver:[96.30,0.94], resc:[86.47,1.84]}, aupr:{brats:[29.18,6.74], liver:[7.05,1.78], resc:[34.99,2.79]}},
      {name:"DPMM (v3-S)",        runtime:149, auroc:{brats:[96.12,0.55],  liver:[90.48,1.05], resc:[86.94,7.76]}, aupr:{brats:[48.09,6.62], liver:[1.94,0.25], resc:[37.70,17.83]}},
      {name:"Ours (standard conv)", runtime:20, auroc:{brats:[97.87,0.24], liver:[97.32,0.24], resc:[94.39,0.10]}, aupr:{brats:[64.70,3.56], liver:[8.44,1.09],  resc:[56.16,1.08]}},
      {name:"Ours (dilated conv)",  runtime:20, auroc:{brats:[98.35,0.02], liver:[96.39,0.04], resc:[93.09,0.19]}, aupr:{brats:[72.42,0.47], liver:[5.51,0.26],  resc:[42.34,1.07]}},
    ];

    function colorFor(name){ return COLOR_MAP[name] || "#9ca3af"; }

    function makeTraces(metricKey, datasetKey){
      const traces = [];
      for (const m of METHODS){
        const v = m[metricKey][datasetKey];
        if (!v) continue;

        const mean = v[0], std = v[1];
        const x = m.runtime;
        const c = colorFor(m.name);

        const hover =
          `<b>${m.name}</b><br>` +
          `${datasetKey.toUpperCase()}<br>` +
          `${metricKey.toUpperCase()}: ${mean.toFixed(2)} ± ${std.toFixed(2)}<br>` +
          `Runtime: ${x} ms`;

        traces.push({
          x: [x],
          y: [mean],
          type: "scatter",
          mode: "markers",
          name: m.name,
          hovertemplate: hover + "<extra></extra>",
          error_y: {type:"data", array:[std], visible:(std>0), color:c, thickness:1.4, width:4},
          marker: {size: 11, color: c, line: {width: 1, color: c}}
        });
      }
      return traces;
    }

    function baseLayout(yTitle){
      const fg = getComputedStyle(document.documentElement).getPropertyValue('--fg').trim();
      const muted = getComputedStyle(document.documentElement).getPropertyValue('--muted').trim();
      const border = getComputedStyle(document.documentElement).getPropertyValue('--border').trim();
      const bg = getComputedStyle(document.documentElement).getPropertyValue('--bg').trim();

      return {
        margin: {l: 58, r: 16, t: 10, b: 52},
        paper_bgcolor: bg,
        plot_bgcolor: bg,
        showlegend: false,
        xaxis: {title: "Runtime [ms]", type: "log", gridcolor: border, zeroline: false, tickfont: {color: muted}, titlefont: {color: muted}},
        yaxis: {title: yTitle, gridcolor: border, zeroline: false, tickfont: {color: muted}, titlefont: {color: muted}},
        font: {color: fg},
      };
    }

    function renderAll(){
      const config = {responsive:true, displayModeBar:false};
      Plotly.newPlot("plot_auroc_brats", makeTraces("auroc","brats"), baseLayout("AUROC [%]"), config);
      Plotly.newPlot("plot_auroc_liver", makeTraces("auroc","liver"), baseLayout("AUROC [%]"), config);
      Plotly.newPlot("plot_auroc_resc",  makeTraces("auroc","resc"),  baseLayout("AUROC [%]"), config);
      Plotly.newPlot("plot_aupr_brats", makeTraces("aupr","brats"), baseLayout("AUPR [%]"), config);
      Plotly.newPlot("plot_aupr_liver", makeTraces("aupr","liver"), baseLayout("AUPR [%]"), config);
      Plotly.newPlot("plot_aupr_resc",  makeTraces("aupr","resc"),  baseLayout("AUPR [%]"), config);
    }

    renderAll();
    if (window.matchMedia){
      window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change", () => renderAll());
    }
  </script>
</body>
</html>